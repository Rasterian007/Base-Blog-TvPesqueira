<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Notícia - TvPesqueira</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Montserrat:wght@800&display=swap" rel="stylesheet">
    <script src="access-control.js" defer></script> 
    
    <style>
        /* --- ESTILOS GERAIS (MANTIDOS CONSISTENTES) --- */
        :root {
            --cor-primaria: #FFD700;
            --cor-secundaria: #051e3e;
            --cor-terciaria: #ffffff;
            --cinza-fundo: #f4f5f7;
            --texto-escuro: #1a1a1a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Open Sans', sans-serif; background-color: var(--cinza-fundo); color: var(--texto-escuro); line-height: 1.6; }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; }
        img { width: 100%; height: auto; display: block; }
        
        /* HEADER */
        header { background-color: var(--cor-secundaria); color: var(--cor-terciaria); position: sticky; top: 0; z-index: 1000; border-bottom: 4px solid var(--cor-primaria); }
        .header-main { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; flex-wrap: wrap; /* Adicionado para mobile */ }
        .logo { font-family: 'Montserrat', sans-serif; font-size: 2rem; font-weight: 800; text-transform: uppercase; letter-spacing: -1px; display: flex; align-items: center; gap: 5px; }
        .logo span.tv { background: var(--cor-primaria); color: var(--cor-secundaria); padding: 0 10px; border-radius: 4px; }
        .logo span.nome { color: var(--cor-terciaria); }
        .nav-menu { display: flex; gap: 20px; }
        .nav-menu a { font-weight: 600; font-size: 0.9rem; text-transform: uppercase; padding: 5px 0; border-bottom: 2px solid transparent; }
        .nav-menu a:hover { color: var(--cor-primaria); border-bottom: 2px solid var(--cor-primaria); }
        .btn-live { background: #cc0000; color: white; padding: 5px 15px; border-radius: 50px; font-weight: bold; font-size: 0.8rem; display: flex; align-items: center; gap: 5px; }
        
        .btn-menu-mobile { display: none; } /* Ocultar por padrão */
        .menu-toggle { display: none; cursor: pointer; color: var(--cor-terciaria); font-size: 1.5rem; } /* Adicionado para mobile */

        /* LAYOUT PRINCIPAL */
        .post-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        /* CONTEÚDO DA NOTÍCIA (MAIN) */
        .post-main {
            background: var(--cor-terciaria);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .post-category {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--cor-secundaria);
            text-transform: uppercase;
            margin-bottom: 10px;
            border-left: 4px solid var(--cor-primaria);
            padding-left: 10px;
        }
        .post-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            line-height: 1.1;
            margin-bottom: 15px;
            color: var(--texto-escuro);
        }
        .post-meta {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .post-image {
            width: 100%;
            height: auto;
            max-height: 500px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .post-body p {
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: var(--texto-escuro);
        }
        .post-body h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.8rem;
            color: var(--cor-secundaria);
        }

        /* SIDEBAR (WIDGETS) */
        .sidebar { 
            position: sticky; 
            top: 90px; 
            align-self: flex-start;
        }
        .widget {
            background: var(--cor-terciaria);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        .widget h4 { 
            font-family: 'Montserrat', sans-serif; 
            font-size: 1.1rem; 
            font-weight: 800; 
            color: var(--cor-secundaria); 
            margin-bottom: 15px; 
            border-bottom: 2px solid var(--cor-primaria); 
            padding-bottom: 5px; 
        }

        /* Widget de Anúncio */
        .ad-widget {
            background: #e0e0e0;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        .ad-widget img { /* NOVO: Estilo para a imagem do anúncio */
            margin: 10px auto 0;
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }
        .ad-widget p { margin: 0; font-size: 0.8rem; color: #888; }
        .ad-widget h4 { color: var(--cor-secundaria); font-size: 1.2rem; margin-top: 5px; margin-bottom: 0; font-family: 'Montserrat', sans-serif; font-weight: 800; }


        /* LISTA TOP (MAIS LIDAS) */
        .top-list li a { 
            display: block; 
            padding: 10px 0; 
            border-bottom: 1px solid #eee;
            font-size: 1rem;
            color: #555;
        }
        .top-list li:last-child a { border-bottom: none; }
        .top-list li a:hover { color: var(--cor-primaria); }

        /* FOOTER */
        footer { background-color: var(--cor-secundaria); color: var(--cor-terciaria); padding: 30px 0; border-top: 4px solid var(--cor-primaria); }
        .footer-content { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 30px; }
        .footer-col h4 { font-family: 'Montserrat', sans-serif; font-size: 1.2rem; margin-bottom: 15px; color: var(--cor-primaria); }
        .footer-col a { display: block; margin-bottom: 8px; font-size: 0.9rem; opacity: 0.8; }
        .footer-col a:hover { opacity: 1; color: var(--cor-terciaria); }

        /* RESPONSIVIDADE */
        @media (max-width: 992px) {
            .post-container { 
                grid-template-columns: 1fr; 
                padding: 0 10px;
            }
            .sidebar {
                position: static;
                order: 2; /* Publicidade abaixo do conteúdo */
            }
            .post-main {
                order: 1;
                padding: 15px;
            }
            .post-title { font-size: 2rem; }
            .header-main { flex-wrap: wrap; }
            .nav-menu { display: none; flex-direction: column; width: 100%; order: 4; }
            .nav-menu.active { display: flex; }
            .menu-toggle { display: block; order: 3; }
        }
        @media (max-width: 600px) {
            .footer-content { grid-template-columns: 1fr 1fr; }
        }

    </style>
</head>
<body>
    <header>
        <div class="header-main">
            <a href="index.html" class="logo">
                <span class="tv">TV</span>
                <span class="nome">PESQUEIRA</span>
            </a>
            <div class="menu-toggle" onclick="toggleMenu()">&#9776;</div>
            <nav class="nav-menu" id="navMenu">
                <a href="index.html">Início</a>
                <a href="categoria.html?cat=Cidade">Cidade</a>
                <a href="categoria.html?cat=Polícia">Polícia</a>
                <a href="categoria.html?cat=Política">Política</a>
                <a href="categoria.html?cat=Esportes">Esportes</a>
                <a href="categoria.html?cat=Vídeos">Vídeos</a>
            </nav>
            <a href="https://www.youtube.com/channel/UCpavRcgQQTc4hv4GSXHFS7A" target="_blank" class="btn-live">
                <i class="fas fa-video"></i> AO VIVO
            </a>
        </div>
    </header>

    <main class="post-container">
        <section class="post-main">
            <h5 class="post-category" id="post-category">Carregando Categoria...</h5>
            <h1 class="post-title" id="post-title">Carregando Título da Notícia...</h1>
            <p class="post-meta" id="post-meta">Por Autor - Data</p>
            
            <img 
                src="" 
                alt="Imagem Principal da Notícia" 
                class="post-image" 
                id="post-image"
                onerror="this.onerror=null; this.src='https://via.placeholder.com/1200x600.png?text=Imagem+Nao+Encontrada'"
            >

            <div class="post-body" id="post-body">
                <p>Carregando conteúdo da matéria...</p>
            </div>
        </section>

        <aside class="sidebar">
            <div class="ad-widget">
                <h4>ANÚNCIO</h4>
                <p>Espaço Publicitário 300x600</p>
                <img src="https://via.placeholder.com/300x600?text=ANUNCIE+AQUI" alt="Banner Publicitário Sidebar" style="margin-top: 15px; border: 1px solid #ccc;">
            </div>
            
            <div class="widget">
                <h4>MAIS LIDAS</h4>
                <ul class="top-list">
                    <li><a href="#">Título de outra notícia popular...</a></li>
                    <li><a href="#">Outro título de notícia...</a></li>
                </ul>
            </div>
        </aside>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-col">
                <div class="logo" style="font-size: 1.5rem;">
                    <span class="tv">TV</span>
                    <span class="nome">PESQUEIRA</span>
                </div>
                <p style="font-size: 0.9rem; opacity: 0.7;">Levando a verdade dos fatos até você. Jornalismo independente e comprometido com a região.</p>
            </div>
            <div class="footer-col">
                <h4>Editorias</h4>
                <a href="categoria.html?cat=Cidade">Cidade</a>
                <a href="categoria.html?cat=Polícia">Polícia</a>
                <a href="categoria.html?cat=Política">Política</a>
                <a href="#">Economia</a>
                <a href="#">Cultura</a>
            </div>
            <div class="footer-col">
                <h4>Institucional</h4>
                <a href="quem-somos.html">Quem Somos</a>
                <a href="#">Anuncie</a>
            </div>
            <div class="footer-col">
                <h4>Redes Sociais</h4>
                <a href="https://www.instagram.com/tvpesqueira" target="_blank">Instagram</a>
                <a href="https://www.facebook.com/tvpesqueira" target="_blank">Facebook</a>
                <a href="https://www.youtube.com/@tvpesqueira" target="_blank">YouTube</a>
                <a href="https://twitter.com/tvpesqueira" target="_blank">Twitter/X</a>
            </div>
        </div>
        <div style="text-align: center; margin-top: 30px; font-size: 0.8rem; opacity: 0.5;">
            &copy; 2023 TvPesqueira. Todos os direitos reservados.
        </div>
    </footer>
    
    <script>
        // Funções de formatação e loadPosts (copiadas do index.html para consistência)
        const DEFAULT_POSTS = [
            { id: 1, title: "Prefeito de Pesqueira Anuncia Novos Projetos de Infraestrutura", description: "Novas obras de pavimentação e saneamento básico começam na próxima semana, prometendo melhorias significativas na vida dos moradores.", content: "O Prefeito XXXXX, em coletiva de imprensa realizada nesta manhã, detalhou o cronograma para os novos projetos de infraestrutura da cidade. A prioridade será a região do bairro YYYY.\n\nAs obras têm previsão de 120 dias para conclusão e foram aprovadas com recursos do governo federal.", author: "Redação TvPesqueira", date: "2025-12-01T10:00:00", category: "Política", img: "https://via.placeholder.com/1200x600.png?text=Noticia+Padrao+1", status: "published" },
            { id: 2, title: "Festival de Cultura Local Bate Recorde de Público", description: "Edição 2025 do festival atrai milhares de visitantes e destaca artistas regionais em diversas categorias.", content: "A Praça ZZZZ ficou lotada durante os três dias do evento, que celebrou a música, dança e culinária de Pesqueira.", author: "Maria Silva", date: "2025-11-29T18:30:00", category: "Cultura", img: "https://via.placeholder.com/300x180.png?text=Noticia+Padrao+2", status: "published" },
            { id: 3, title: "Economia: Comércio Pesqueirense Projeta Alta nas Vendas de Final de Ano", description: "Expectativa é de crescimento de 15% em relação ao ano passado, impulsionado por novas lojas e crédito facilitado.", content: "A Câmara de Dirigentes Lojistas (CDL) de Pesqueira divulgou o levantamento otimista, que aponta o setor de vestuário e eletrônicos como os principais motores do crescimento.", author: "João Batista", date: "2025-11-28T09:15:00", category: "Economia", img: "https://via.placeholder.com/300x180.png?text=Noticia+Padrao+3", status: "published" },
            { id: 4, title: "Nova Delegacia Inaugurada no Centro", description: "Melhoria na segurança pública local.", content: "A nova unidade policial deve atender uma área com mais de 30 mil habitantes.", author: "Redação", date: "2025-11-27T14:00:00", category: "Polícia", img: "https://via.placeholder.com/300x180.png?text=Noticia+Padrao+4", status: "published" },
        ];
        // 2. Definimos a chave do LocalStorage
        const POSTS_STORAGE_KEY = 'tvpesqueira_posts';
        
        // 3. A função loadPosts() NÃO RETORNA MAIS AS POSTAGENS PADRÃO
        function loadPosts() {
            const postsJson = localStorage.getItem(POSTS_STORAGE_KEY);
            let posts;
            try {
                // Tenta fazer o parse do JSON do localStorage
                posts = JSON.parse(postsJson);
            } catch (e) {
                console.error("Erro ao carregar posts do localStorage:", e);
                // Em caso de erro de parse, trata como array vazia
                posts = []; 
            }
            
            // Retorna posts do localStorage se existirem e forem válidos, senão retorna array vazia
            // O blog AGORA COMEÇA VAZIO se não houver nada salvo.
            return (Array.isArray(posts) && posts.length > 0) ? posts : [];
        }
        
        function formatDate(dateString) {
            // (Mantenha o resto da função formatDate original)
            if (!dateString) return 'Data Desconhecida';
            try {
                const date = new Date(dateString);
                if (isNaN(date)) return 'Data Inválida';
                
                const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
                return date.toLocaleDateString('pt-BR', options);
            } catch (e) {
                return 'Erro na Data';
            }
        }
        // FIM das Funções de formatação e loadPosts

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const postId = urlParams.get('id');

            const postTitleElement = document.getElementById('post-title');
            const postCategoryElement = document.getElementById('post-category');
            const postMetaElement = document.getElementById('post-meta');
            const postImageElement = document.getElementById('post-image');
            const postBodyElement = document.getElementById('post-body');

            if (postId) {
                const allPosts = loadPosts();
                const post = allPosts.find(p => p.id == postId && p.status === 'published');
                
                if (post) {
                    // Preenche os dados da notícia
                    document.getElementById('page-title').textContent = `${post.title} - TvPesqueira`;
                    postTitleElement.textContent = post.title;
                    postCategoryElement.textContent = post.category || 'Geral';
                    postMetaElement.textContent = `Por ${post.author || 'Redação'} - ${formatDate(post.date)}`;
                    
                    // A imagem principal usa fallback aqui. O onerror no HTML garante que algo será exibido.
                    postImageElement.src = post.img || 'https://via.placeholder.com/1200x600.png?text=Imagem+da+Noticia';
                    postImageElement.alt = post.title;

                    // Converte texto do post em parágrafos HTML
                    const paragraphs = (post.content || post.description || "").split('\n').filter(p => p.trim() !== '').map(p => `<p>${p}</p>`).join('');
                    postBodyElement.innerHTML = paragraphs || `<p>Conteúdo completo da matéria não disponível.</p>`;
                    
                } else {
                    // Se o ID existir mas o post não for encontrado ou não estiver publicado
                    postTitleElement.textContent = "Notícia Não Encontrada ou Não Publicada (404)";
                    postBodyElement.innerHTML = `<div class="error-message">
                        <h2>Conteúdo Não Encontrado</h2>
                        <p>A notícia que você está procurando não existe, não foi publicada ou foi removida do sistema.</p>
                    </div>`;
                }
            } else {
                 // Se não houver ID na URL
                 postTitleElement.textContent = "Notícia Não Especificada (Erro de URL)";
                 postBodyElement.innerHTML = `<div class="error-message">
                        <h2>Notícia Inválida</h2>
                        <p>O link da notícia está incompleto. Tente voltar para a página principal.</p>
                    </div>`;
            }
        });
        
        function toggleMenu() {
            var menu = document.getElementById("navMenu");
            menu.classList.toggle("active");
        }
    </script>
</body>
</html>
